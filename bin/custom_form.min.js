(function(g){var n={},l=["init","checked","update","select","disabled"],d={disabled:function(r){(r!=undefined)||(r="all");if(this.length==1){return n[this[0].$$custom_form_identifier].instance.disabled(r)}var c=r=="any"?false:true;var f=this;this.each(function(){var s=n[this.$$custom_form_identifier].instance.disabled(r);switch(r){case"all":if(c&&!s){c=false;return false}break;case"any":if(s){c=true;return false}break;case"none":if(!s){c=false;return false}break}});return c}};p.total_instances=0;p.build=function(f){var r,c;if(f.is("select")){r="select"}else{r="input_"+f.attr("type")}if(!(c=this.available_classes[r])){throw ("No class available to build element of type "+r)}return new c(r+"_"+p.total_instances++)};p.available_classes={};p.register_class=function(f,c){this.available_classes[f]=c};function p(c){this.identifier=c}var i=p.prototype;g.extend(i,{get_element:function(){return n[this.identifier].element},get:function(c){return n[this.identifier].children[c]},set:function(f,c){n[this.identifier].children[c]=f;return f},get_id:function(){return this.identifier},kill:function(){return this.identifier},active_replacement_class:function(c){this.replacement[c?"addClass":"removeClass"]("checked_"+this.element_type)},init:function(c){var f=this.get_element(),r;this.set_parameters(f,c);r=this.set_replacement(f);this.replace_elements(f,r);this.init_replacement(f,r);this.init_mouse_events(f,r);return this},set_replacement:function(c){return this.set(this.get_replacement(c),"replacement")},init_mouse_events:function(f,r){this.mouse_trigger().bind("mouseenter",this,this.hover_handler).bind("mouseleave",this,this.out_handler).bind("click",this,this.click_handler).bind("mouseup",this,this.mouse_up_handler).bind("mousedown",this,this.mouse_down_handler);var c=g("label[for="+this.element_id+"]");if(c.length!=0){c.bind("click",this,this.label_handler)}else{c=r.parent("label");if(c.length!=0){c.bind("click",this,this.label_handler)}}},label_handler:function(c){if(c.target!=this){return}c.preventDefault();c.data.get("replacement").triggerHandler("click")},hover_handler:function(c){c.data.hover(true)},out_handler:function(c){c.data.hover(false)},mouse_up_handler:function(c){c.data.mouse_in(false)},mouse_down_handler:function(c){c.data.mouse_in(true)},hover:function(c){this.get("replacement")[c?"addClass":"removeClass"]("hover_"+this.element_type)},mouse_in:function(c){this.get("replacement")[c?"addClass":"removeClass"]("active_"+this.element_type)},disabled:function(r,c,f){var c=(c)||(this.get_element()),f;switch(r){case true:case false:f=(f)||(this.get("replacement"));c.attr("disabled",r);f[r?"addClass":"removeClass"]("disabled_"+this.element_type);this.is_disabled=r;return r;case"none":return !c.is(":disabled");default:return c.is(":disabled")}},disable_if_disabled:function(c){if(this.is_disabled!=c.is(":disabled")){this.disabled(!this.is_disabled,c)}}});function e(c){this.constructor.call(this,c)}e.IDENTIFIER="input_checkbox";var m=e.prototype=new p();m.constructor=p.prototype.constructor;g.extend(m,{element_type:"checkbox",uncheckeable:false,set_parameters:function(f,c){this.element_id=f.attr("id");this.element_name=f.attr("name")},get_replacement:function(c){return g("<span class='"+this.element_type+"'></span>")},replace_elements:function(c,f){c.after(f);f.append(c)},init_replacement:function(c,f){if(c.is(":checked")){this.checked(true,c,f)}if(c.is(":disabled")){this.disabled(true,c,f)}},checked:function(r,c,f){c=(c)||(this.get_element());f=(f)||(this.get("replacement"));r=r==undefined?!c.is(":checked"):r;if(!this.uncheckeable||(this.uncheckeable&&r)){c.attr("checked",r);f[r?"addClass":"removeClass"]("checked_"+this.element_type);if(r){c.trigger("change")}}},mouse_trigger:function(){return this.get("replacement")},click_handler:function(c){c.data.checked();c.data.get_element().triggerHandler("click")},update:function(){var c=this.get_element();this.disable_if_disabled(c);this.checked(c.is(":checked"),c)}});p.register_class(e.IDENTIFIER,e);function o(c){this.constructor.call(this,c)}o.IDENTIFIER="input_radio";var b=o.prototype=new e();b.constructor=p.prototype.constructor;g.extend(b,{uncheckeable:true,element_type:"radio",update:function(){var c=this.get_element();this.disable_if_disabled(c);this.checked(c.is(":checked"),c,null,true)},checked:function(s,c,r,f){c=(c)||(this.get_element());r=(r)||(this.get("replacement"));(s!=undefined)||(s=true);if(s||f){var t=g(".checked_radio").has("[name='"+this.element_name+"']").not(this.element_id);if(t.length!=0){t.removeClass("checked_"+this.element_type)}}e.prototype.checked.call(this,s)}});p.register_class(o.IDENTIFIER,o);function a(c){this.constructor.call(this,c)}a.IDENTIFIER="select";var q=a.prototype=new p();q.constructor=p.prototype.constructor;g.extend(q,{button_width:0,click_handler:g.noop,element_type:"select",set_parameters:function(f,c){this.responsive=c.responsive_select},get_replacement:function(c){var f=g("option:selected",c);(f.length!=0)||(f=g("option:first-child",c));return g("<span class='select'><span class='select_content' ><span class='select_button'><span class='select_button_icon'></span></span><p class='select_label'><span>"+f.text()+"</span></p></span></span>")},replace_elements:function(c,f){this.element_width=c.outerWidth();c.after(f);f.append(c)},init_replacement:function(f,r){var t=this.set(g(".select_label",r),"select_label");if(!this.responsive){var s={width:this.element_width-parseInt(r.css("border-left-width"))-parseInt(r.css("border-right-width"))};f.css(s);r.css(s);var c=g(".select_button",r);t.css({width:s.width-c.outerWidth()})}else{r.addClass("responsive_select")}f.bind("change",this,this.select_change)},select_change:function(c){c.data.update_label()},update_label:function(){this.get("select_label").html("<span>"+g("option:selected",this.get_element()).text()+"</span>")},mouse_trigger:function(){return this.get_element()},update:function(){var c=this.get_element();this.disable_if_disabled(c);c.trigger("change")},select:function(r){var f=typeof r,c=this.get_element();switch(f){case"number":c.val(g(":nth-child("+r+")",c).val());break;case"function":r.apply(c);break;default:(f=="string")||(r=r.to_s);c.find("option:contains('"+r+"')").attr("selected",true)}this.update()}});p.register_class(a.IDENTIFIER,a);function j(c){this.constructor.call(this,c)}j.IDENTIFIER="input_file";var k=j.prototype=new p();k.constructor=p.prototype.constructor;g.extend(k,{click_handler:g.noop,element_type:"file",set_parameters:function(f,c){this.label=c.file_label;this.button_label=c.file_button;this.responsive=c.responsive_file},get_replacement:function(){return g("<span class='file'><span class='file_content'><span class='file_button'><span></span>"+this.button_label+"</span><p class='file_label'><span>"+this.label+"</span></p></span></span>")},replace_elements:function(c,f){if(!this.responsive){this.element_width=c.outerWidth();this.element_margin=c.css("margin-left");this.element_padding=c.css("padding-left")}c.after(f);f.append(c)},init_replacement:function(f,r){var c=c=this.set(g(".file_label",r),"file_label");f.bind("change",this,this.file_change);if(!this.responsive){var s={width:this.element_width-parseInt(r.css("border-left-width"))-parseInt(r.css("border-right-width"))};f.css(s);r.css(s);c.css("width",s.width-g(".file_button",r).outerWidth())}else{r.addClass("responsive_file")}},mouse_trigger:function(){return this.get_element()},file_change:function(c){c.data.update_label()},update_label:function(){var c=this.get_element().val();if(!c.match(/\S/)){c=this.label}this.get("file_label").html("<span>"+c+"</span>")},update:function(){var c=this.get_element();this.disable_if_disabled(c);c.trigger("change")}});p.register_class(j.IDENTIFIER,j);function h(){this.init=function(s,r){var f=this,r=g.extend({file_button:"Choose file",file_label:"No file chosen",responsive_select:false,responsive_file:false},(r||{}));return s.each(function(){if((this.nodeName=="SELECT"&&this.size>0)||this.$$custom_form_initialized){return true}this.$$custom_form_identifier=f.new_element(this).init(r).identifier})};this.execute=function c(s,r){var t=r[0];var f=Array.prototype.slice.call(r,1);if(t in d){return d[t].apply(s,f)}return s.each(function(){if(this.$$custom_form_identifier){var u=n[this.$$custom_form_identifier].instance;u[t].apply(u,f)}})};this.new_element=function(t,s){var r=g(t),f=p.build(r,s),u=f.get_id();this.register_instance(u,f,r);return f};this.register_instance=function(s,f,r){n[s]={element:r,instance:f,children:{}}};this.unregister_instance=function(f){var r=f.get_id();f=f.kill();delete n[r]}}h.get_custom_form_instance=function(){if(!this.instance){this.instance=new h()}return this.instance};g.fn.custom_form=function(f){var c=h.get_custom_form_instance();if((typeof f!="string")||!f){return c.init(this,f)}else{return c.execute(this,arguments)}}})(jQuery);