(function(g){var o={fn:{}},l=["init","checked","update","select","disabled"],d={disabled:function(r){(r!=undefined)||(r="all");if(this.length==1){return o[this[0].$$custom_form_identifier].instance.disabled(r)}var c=r=="any"?false:true;var f=this;this.each(function(){var s=o[this.$$custom_form_identifier].instance.disabled(r);switch(r){case"all":if(c&&!s){c=false;return false}break;case"any":if(s){c=true;return false}break;case"none":if(!s){c=false;return false}break}});return c}};o._browser=g.browser||(function(){var r,s,f;f=function(c){c=c.toLowerCase();var u=/(chrome)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||c.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(c)||[];return{browser:u[1]||"",version:u[2]||"0"}};r=f(navigator.userAgent);s={};if(r.browser){s[r.browser]=true;s.version=r.version}if(s.chrome){s.webkit=true}else{if(s.webkit){s.safari=true}}return s})();function n(c,f){f=parseFloat(c.css(f));if(isNaN(f)){return 0}return f}q.total_instances=0;q.browser_string=function(){var s,f,r,c=o._browser;for(s in c){if(s=="version"){f=parseInt(c.version)}else{r=s}}return r+" "+r+f+(c.msie?"":" not_msie")}();q.build=function(f){var r,c;if(f.is("select")){r="select"}else{r="input_"+f.attr("type")}if(!(c=this.available_classes[r])){throw ("No class available to build element of type "+r)}return new c(r+"_"+q.total_instances++)};q.available_classes={};q.register_class=function(f,c){this.available_classes[f]=c};function q(c){this.identifier=c}var i=q.prototype;g.extend(i,{is_disabled:false,get_element:function(){return o[this.identifier].element},get:function(c){return o[this.identifier].children[c]},set:function(f,c){o[this.identifier].children[c]=f;return f},get_id:function(){return this.identifier},kill:function(){return this.identifier},active_replacement_class:function(c){this.replacement[c?"addClass":"removeClass"]("checked_"+this.element_type)},init:function(f){var r=this.get_element(),s,c=r.attr("id");this.set_parameters(r,f);s=this.set_replacement(r);s.addClass(q.browser_string);if(c.match(/\S/)){s.addClass("custom-form_"+c)}this.replace_elements(r,s);this.init_replacement(r,s);this.disable_if_disabled(r);this.init_mouse_events(r,s);return this},set_replacement:function(c){return this.set(this.get_replacement(c),"replacement")},init_mouse_events:function(f,r){var s=this.mouse_trigger(),c;s.bind("mouseenter",this,this.hover_handler).bind("mouseleave",this,this.out_handler).bind("mouseup",this,this.mouse_up_handler).bind("mousedown",this,this.mouse_down_handler);c=r.parent("label");if(c.length==0){s.bind("click",this,this.click_handler)}f.bind("focusin",this,this.focus_in).bind("focusout",this,this.focus_out).bind("change",this,this.change)},focus_in:function(c){c.data.focus(true)},focus_out:function(c){c.data.focus(false)},focus:function(c){if(this.is_disabled){return}this.get("replacement")[c?"addClass":"removeClass"]("focus_"+this.element_type)},change:function(){},label_handler:function(c){if(c.target!=this){return}c.preventDefault();c.data.get_element().triggerHandler("change")},hover_handler:function(c){c.data.hover(true)},out_handler:function(c){c.data.hover(false)},mouse_up_handler:function(c){c.data.mouse_in(false)},mouse_down_handler:function(c){c.data.mouse_in(true)},hover:function(c){if(this.is_disabled){return}this.get("replacement")[c?"addClass":"removeClass"]("hover_"+this.element_type)},mouse_in:function(c){if(this.is_disabled){return}this.get("replacement")[c?"addClass":"removeClass"]("active_"+this.element_type)},disabled:function(r,c,f){var c=(c)||(this.get_element()),f;switch(r){case true:case false:f=(f)||(this.get("replacement"));c.attr("disabled",r);f[r?"addClass":"removeClass"]("disabled_"+this.element_type);this.is_disabled=r;return r;case"none":return !c.is(":disabled");default:return c.is(":disabled")}},disable_if_disabled:function(c){if(this.is_disabled!=c.is(":disabled")){this.disabled(!this.is_disabled,c)}}});function e(c){this.constructor.call(this,c)}e.IDENTIFIER="input_checkbox";var m=e.prototype=new q();m.constructor=q.prototype.constructor;g.extend(m,{element_type:"checkbox",uncheckeable:false,set_parameters:function(f,c){this.element_id=f.attr("id");this.element_name=f.attr("name")},get_replacement:function(c){return g("<span class='"+this.element_type+"'></span>")},replace_elements:function(c,f){c.after(f);f.append(c)},init_replacement:function(f,r){var u,s;if((u=f.is(":checked"))){this.checked(true,f,r)}if((s=f.is(":disabled"))){this.disabled(true,f,r)}if(u||s){this.update(f,r)}},checked:function(r,c,f){c=(c)||(this.get_element());f=(f)||(this.get("replacement"));r=r==undefined?!c.is(":checked"):r;if(!this.uncheckeable||(this.uncheckeable&&r)){c.prop("checked",r);c.trigger("change")}},mouse_trigger:function(){return this.get("replacement")},click_handler:function(f){if(f.data.is_disabled){return}var c=f.data;c.get_element().focus().triggerHandler("click");if(f.target==this){c.checked()}},change:function(c){c.data.update(g(this))},update:function(f,r){var f=(f||this.get_element()),c="checked_"+this.element_type,s=f.is(":checked"),r=(r||this.get("replacement"));this.disable_if_disabled(f);if(s&&!r.hasClass(c)){r.addClass(c)}else{if(!s&&r.hasClass(c)){r.removeClass(c)}}}});q.register_class(e.IDENTIFIER,e);function p(c){this.constructor.call(this,c)}p.IDENTIFIER="input_radio";var b=p.prototype=new e();b.constructor=q.prototype.constructor;g.extend(b,{uncheckeable:true,element_type:"radio",update:function(f,r){var f=(f||this.get_element()),c="checked_"+this.element_type,s=f.is(":checked"),r=(r||this.get("replacement"));this.disable_if_disabled(f);if(s){var u=g("."+c).has("[name='"+this.element_name+"']").not(this.element_id);if(u.length!=0){u.removeClass(c)}r.addClass(c)}}});q.register_class(p.IDENTIFIER,p);q.element_border_width=function(c){return parseInt(c.css("border-left-width"))-parseInt(c.css("border-right-width"))};function a(c){this.constructor.call(this,c)}a.IDENTIFIER="select";var t=a.prototype=new q();t.constructor=q.prototype.constructor;g.extend(t,{button_width:0,click_handler:g.noop,element_type:"select",redraw:function(){var r=this.get_element();r.removeAttr("style");this.element_width=r.outerWidth();var s=this.get("replacement"),f=s.find(".select_content"),v=this.set(g(".select_label",s),"select_label"),u={width:this.element_width-n(s,"border-left-width")-n(s,"border-right-width")};r.css(u);s.css(u);var c=g(".select_button",s);v.css({width:u.width-c.outerWidth()-n(f,"border-left-width")-n(f,"border-right-width")-n(v,"border-right-width")-n(v,"border-left-width")})},set_parameters:function(f,c){this.responsive=c.responsive_select},get_replacement:function(c){var f=g("option:selected",c);(f.length!=0)||(f=g("option:first-child",c));return g("<span class='select'><span class='select_content' ><span class='select_button'><span class='select_button_icon'></span></span><span class='select_label'><span>"+f.text()+"</span></span></span></span>")},replace_elements:function(c,f){this.element_width=c.outerWidth();c.after(f);f.append(c)},init_replacement:function(c,f){var r=this.set(g(".select_label",f),"select_label");if(!this.responsive){this.redraw()}else{f.addClass("responsive_select")}c.bind("change",this,this.select_change)},init_mouse_events:function(c,f){q.prototype.init_mouse_events.call(this,c,f);if(o._browser.mozilla||o._browser.msie){c.bind("keyup",this,this.key_up)}},key_up:function(c){if(c.which==38||c.which==40){c.data.update()}},select_change:function(c){c.data.update_label()},update_label:function(){this.get("select_label").html("<span>"+g("option:selected",this.get_element()).text()+"</span>")},mouse_trigger:function(){return this.get_element()},update:function(){var c=this.get_element();this.disable_if_disabled(c);c.trigger("change")},select:function(r){var f=typeof r,c=this.get_element();switch(f){case"number":c.val(g(":nth-child("+r+")",c).val());break;case"function":r.apply(c);break;default:(f=="string")||(r=r.to_s);c.find("option:contains('"+r+"')").prop("selected",true)}this.update()}});q.register_class(a.IDENTIFIER,a);function j(c){this.constructor.call(this,c)}j.IDENTIFIER="input_file";var k=j.prototype=new q();k.constructor=q.prototype.constructor;g.extend(k,{click_handler:g.noop,element_type:"file",set_parameters:function(f,c){this.label=c.file_label;this.button_label=c.file_button;this.responsive=c.responsive_file},get_replacement:function(){return g("<span class='file'><span class='file_content'><span class='file_button'><span></span>"+this.button_label+"</span><span class='file_label'><span>"+this.label+"</span></span></span></span>")},replace_elements:function(c,r){if(!this.responsive){this.element_width=c.outerWidth();this.element_margin=c.css("margin-left");this.element_padding=c.css("padding-left")}c.after(r);var f=g("<span class='file_wrap'></span>");r.append(f);f.append(c)},init_replacement:function(f,r){var c=c=this.set(g(".file_label",r),"file_label");f.bind("change",this,this.file_change);if(!this.responsive){var s={width:this.element_width-parseInt(r.css("border-left-width"))-parseInt(r.css("border-right-width"))};f.css(s);r.css(s)}else{r.addClass("responsive_file")}},mouse_trigger:function(){return this.get_element()},file_change:function(c){c.data.update_label()},update_label:function(){var c=this.get_element().val();if(!c.match(/\S/)){c=this.label}this.get("file_label").html("<span>"+c+"</span>")},update:function(){var c=this.get_element();this.disable_if_disabled(c);c.trigger("change")}});q.register_class(j.IDENTIFIER,j);o.fn.ie6=function(){return o._browser.msie&&parseInt(o._browser.version)<=6};o.fn.ie6_instance=function(){return new function(){this.init=this.execute=function(c){return c}}()};function h(){this.init=function(s,r){var f=this,r=g.extend({file_button:"Choose file",file_label:"No file chosen",responsive_select:false,responsive_file:false},(r||{}));s=s.each(function(){if((this.nodeName=="SELECT"&&this.size>0)||this.$$custom_form_identifier){return true}this.$$custom_form_identifier=f.new_element(this).init(r).identifier});return s};this.execute=function c(s,r){var u=r[0];var f=Array.prototype.slice.call(r,1);if(u in d){return d[u].apply(s,f)}return s.each(function(){if(this.$$custom_form_identifier){var v=o[this.$$custom_form_identifier].instance;v[u].apply(v,f)}})};this.new_element=function(u,s){var r=g(u),f=q.build(r,s),v=f.get_id();this.register_instance(v,f,r);return f};this.register_instance=function(s,f,r){o[s]={element:r,instance:f,children:{}}};this.unregister_instance=function(f){var r=f.get_id();f=f.kill();delete o[r]}}h.get_custom_form_instance=function(){if(!this.instance){this.instance=!o.fn.ie6()?new h():o.fn.ie6_instance()}return this.instance};g.fn.custom_form=function(f){var c=h.get_custom_form_instance();if((typeof f!="string")||!f){return c.init(this,f)}else{return c.execute(this,arguments)}}})(jQuery);